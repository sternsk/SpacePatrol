import { OfflineContext } from "../../core/context/OfflineContext.js";
/**
 * Render a segment of the oscillator to an offline context and return the results as an array
 */
export async function generateWaveform(instance, length) {
    const duration = length / instance.context.sampleRate;
    const context = new OfflineContext(1, duration, instance.context.sampleRate);
    const clone = new instance.constructor(Object.assign(instance.get(), {
        // should do 2 iterations
        frequency: 2 / duration,
        // zero out the detune
        detune: 0,
        context,
    })).toDestination();
    clone.start(0);
    const buffer = await context.render();
    return buffer.getChannelData(0);
}
